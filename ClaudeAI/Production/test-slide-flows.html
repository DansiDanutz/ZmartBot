<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZmartBot - Slide Flow Tester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .test-card h2 {
            color: #1e293b;
            font-size: 1.25rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-card h2 .icon {
            font-size: 1.5rem;
        }

        .test-list {
            list-style: none;
        }

        .test-list li {
            padding: 10px;
            margin-bottom: 10px;
            background: #f8fafc;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-list li:hover {
            background: #e2e8f0;
            transform: translateX(5px);
        }

        .status {
            font-size: 0.875rem;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: auto;
        }

        .status.ready {
            background: #10b981;
            color: white;
        }

        .status.testing {
            background: #f59e0b;
            color: white;
        }

        .status.blocked {
            background: #ef4444;
            color: white;
        }

        .flow-diagram {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .flow-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .flow-step {
            text-align: center;
            position: relative;
            flex: 1;
            min-width: 100px;
        }

        .flow-step .number {
            width: 40px;
            height: 40px;
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }

        .flow-step.active .number {
            background: #10b981;
            animation: pulse 2s infinite;
        }

        .flow-step.blocked .number {
            background: #ef4444;
        }

        .flow-step .label {
            font-size: 0.875rem;
            color: #64748b;
        }

        .flow-step:not(:last-child)::after {
            content: '‚Üí';
            position: absolute;
            top: 20px;
            right: -25px;
            color: #cbd5e1;
            font-size: 1.5rem;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .test-controls {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #64748b;
            color: white;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .status-panel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .status-item {
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        .status-item h4 {
            color: #64748b;
            font-size: 0.875rem;
            margin-bottom: 5px;
        }

        .status-item .value {
            color: #1e293b;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .iframe-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        iframe {
            width: 100%;
            height: 800px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
        }

        .info-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }

        .info-box h3 {
            color: #92400e;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #78350f;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ ZmartBot Slide Flow Tester</h1>

        <!-- Flow Diagram -->
        <div class="flow-diagram">
            <h2 style="margin-bottom: 20px; color: #1e293b;">Current Navigation Flow</h2>
            <div class="flow-steps" id="flowSteps">
                <div class="flow-step active" data-step="1">
                    <div class="number">1</div>
                    <div class="label">Welcome</div>
                </div>
                <div class="flow-step" data-step="2">
                    <div class="number">2</div>
                    <div class="label">Auth Method</div>
                </div>
                <div class="flow-step" data-step="3">
                    <div class="number">3</div>
                    <div class="label">Credentials</div>
                </div>
                <div class="flow-step" data-step="4">
                    <div class="number">4</div>
                    <div class="label">Verify OTP</div>
                </div>
                <div class="flow-step" data-step="5">
                    <div class="number">5</div>
                    <div class="label">Reset Pass</div>
                </div>
                <div class="flow-step" data-step="6">
                    <div class="number">6</div>
                    <div class="label">Info</div>
                </div>
                <div class="flow-step" data-step="7">
                    <div class="number">7</div>
                    <div class="label">Pricing</div>
                </div>
                <div class="flow-step" data-step="8">
                    <div class="number">8</div>
                    <div class="label">Profile</div>
                </div>
                <div class="flow-step" data-step="9">
                    <div class="number">9</div>
                    <div class="label">Complete</div>
                </div>
            </div>
        </div>

        <!-- Test Controls -->
        <div class="test-controls">
            <button class="btn btn-primary" onclick="openLiveSite()">üåê Open Live Site</button>
            <button class="btn btn-success" onclick="testRegistration()">‚úÖ Test Registration</button>
            <button class="btn btn-secondary" onclick="testLogin()">üîë Test Login</button>
            <button class="btn btn-primary" onclick="testGoogleAuth()">üî∑ Test Google OAuth</button>
            <button class="btn btn-danger" onclick="testPasswordReset()">üîí Test Password Reset</button>
            <button class="btn btn-secondary" onclick="testNavigation()">‚¨ÖÔ∏è‚û°Ô∏è Test Navigation</button>
        </div>

        <!-- Status Panel -->
        <div class="status-panel">
            <h2 style="color: #1e293b;">System Status</h2>
            <div class="status-grid">
                <div class="status-item">
                    <h4>Current Step</h4>
                    <div class="value" id="currentStep">1</div>
                </div>
                <div class="status-item">
                    <h4>Auth Method</h4>
                    <div class="value" id="authMethod">None</div>
                </div>
                <div class="status-item">
                    <h4>Email Verified</h4>
                    <div class="value" id="emailVerified">No</div>
                </div>
                <div class="status-item">
                    <h4>Plan Selected</h4>
                    <div class="value" id="planSelected">None</div>
                </div>
                <div class="status-item">
                    <h4>Navigation Mode</h4>
                    <div class="value" id="navMode">Mouse</div>
                </div>
                <div class="status-item">
                    <h4>Completion</h4>
                    <div class="value" id="completion">0%</div>
                </div>
            </div>
        </div>

        <!-- Test Categories -->
        <div class="test-grid">
            <!-- Authentication Tests -->
            <div class="test-card">
                <h2><span class="icon">üîê</span>Authentication Flows</h2>
                <ul class="test-list">
                    <li onclick="runTest('email-register')">
                        üìß Email Registration
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('email-login')">
                        üîë Email Login
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('google-oauth')">
                        üî∑ Google OAuth
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('forgot-password')">
                        üîí Forgot Password
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>

            <!-- Email Management Tests -->
            <div class="test-card">
                <h2><span class="icon">üìß</span>Email Management</h2>
                <ul class="test-list">
                    <li onclick="runTest('welcome-email')">
                        üëã Welcome Email
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('otp-email')">
                        üî¢ OTP Verification
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('reset-email')">
                        üîÑ Password Reset
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('resend-code')">
                        üì® Resend Code (Rate Limited)
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>

            <!-- Navigation Tests -->
            <div class="test-card">
                <h2><span class="icon">üéÆ</span>Navigation Controls</h2>
                <ul class="test-list">
                    <li onclick="runTest('arrow-keys')">
                        ‚¨ÖÔ∏è‚û°Ô∏è Arrow Keys
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('swipe-mobile')">
                        üëÜ Touch Swipe
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('back-restrictions')">
                        üö´ Back Restrictions
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('skip-conditions')">
                        ‚è≠Ô∏è Skip Conditions
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>

            <!-- Conditional Logic Tests -->
            <div class="test-card">
                <h2><span class="icon">üîÑ</span>Conditional Logic</h2>
                <ul class="test-list">
                    <li onclick="runTest('auth-required')">
                        üîê Auth Required (Step 2‚Üí3)
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('email-verify')">
                        ‚úâÔ∏è Email Verify (Step 4)
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('plan-selection')">
                        üí≥ Plan Selection (Step 7)
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('profile-complete')">
                        üë§ Profile Complete (Step 8)
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>

            <!-- State Management Tests -->
            <div class="test-card">
                <h2><span class="icon">üíæ</span>State Management</h2>
                <ul class="test-list">
                    <li onclick="runTest('session-persist')">
                        üîÑ Session Persistence
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('refresh-state')">
                        üîÉ Refresh State
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('rate-limiting')">
                        ‚è±Ô∏è Rate Limiting
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('error-recovery')">
                        üîß Error Recovery
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>

            <!-- Supabase Integration Tests -->
            <div class="test-card">
                <h2><span class="icon">üóÑÔ∏è</span>Supabase Integration</h2>
                <ul class="test-list">
                    <li onclick="runTest('auth-signup')">
                        ‚úÖ auth.signUp()
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('auth-signin')">
                        üîë auth.signIn()
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('auth-reset')">
                        üîí auth.resetPassword()
                        <span class="status ready">Ready</span>
                    </li>
                    <li onclick="runTest('auth-resend')">
                        üì® auth.resend()
                        <span class="status ready">Ready</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Info Box -->
        <div class="info-box">
            <h3>üìã Testing Instructions</h3>
            <p>
                1. Click "Open Live Site" to test the actual onboarding flow<br>
                2. Use the test buttons to simulate different user journeys<br>
                3. Watch the flow diagram update as you navigate<br>
                4. Check the status panel for current state information<br>
                5. Click individual tests to verify specific functionality
            </p>
        </div>

        <!-- Live Site Frame -->
        <div class="iframe-container">
            <h2 style="margin-bottom: 20px; color: #1e293b;">Live Site Preview</h2>
            <iframe id="liveSite" src="https://vermillion-paprenjak-67497b.netlify.app/" title="Live Onboarding"></iframe>
        </div>
    </div>

    <script>
        // Update flow diagram based on current step
        function updateFlowDiagram(step) {
            document.querySelectorAll('.flow-step').forEach(el => {
                el.classList.remove('active', 'blocked');
                const stepNum = parseInt(el.dataset.step);
                if (stepNum === step) {
                    el.classList.add('active');
                } else if (stepNum === 4 && !emailVerified) {
                    el.classList.add('blocked');
                }
            });
            document.getElementById('currentStep').textContent = step;
            document.getElementById('completion').textContent = Math.round((step / 9) * 100) + '%';
        }

        // Test functions
        function openLiveSite() {
            window.open('https://vermillion-paprenjak-67497b.netlify.app/', '_blank');
        }

        function testRegistration() {
            alert(`Testing Registration Flow:

1. Opening live site
2. Click "Get Started"
3. Choose "Continue with Email"
4. Enter new email: test${Date.now()}@example.com
5. Enter password: TestPassword123!
6. Confirm password
7. Click "Create Account"
8. Check email for 6-digit OTP code
9. Enter code in verification boxes
10. Continue through remaining steps

Note: You'll need a real email to receive the OTP code.`);
            openLiveSite();
        }

        function testLogin() {
            alert(`Testing Login Flow:

1. Opening live site
2. Click "Get Started"
3. Choose "Continue with Email"
4. Toggle to "Sign In" mode
5. Enter existing email
6. Enter password
7. Click "Sign In"
8. Should skip OTP and go to Step 6

Note: Requires an existing account.`);
            openLiveSite();
        }

        function testGoogleAuth() {
            alert(`Testing Google OAuth:

1. Opening live site
2. Click "Get Started"
3. Choose "Sign in with Google"
4. Complete Google authentication
5. Should auto-redirect to Step 6
6. Email is pre-verified via OAuth

Note: Requires Google account.`);
            openLiveSite();
        }

        function testPasswordReset() {
            alert(`Testing Password Reset:

1. Opening live site
2. Go to Sign In
3. Click "Forgot Password?"
4. Enter email address
5. Check email for reset link
6. Click link in email
7. Enter new password
8. Return to sign in with new password

Note: Requires existing account.`);
            openLiveSite();
        }

        function testNavigation() {
            alert(`Testing Navigation Controls:

KEYBOARD:
- Press Right Arrow ‚Üí Next step
- Press Left Arrow ‚Üí Previous step
- Press ESC ‚Üí Close modals

MOBILE:
- Swipe Left ‚Üí Next step
- Swipe Right ‚Üí Previous step

CONDITIONS:
- Try to skip Step 4 (should be blocked)
- Try to proceed without selecting plan (blocked)
- Try going back after verification

Note: Some steps have conditions that prevent navigation.`);
            openLiveSite();
        }

        function runTest(testType) {
            const testDescriptions = {
                'email-register': 'Creates new account with email/password and OTP verification',
                'email-login': 'Signs in existing user, skips OTP step',
                'google-oauth': 'Uses Google OAuth, skips email verification',
                'forgot-password': 'Sends password reset email with link',
                'welcome-email': 'Sent after successful registration',
                'otp-email': 'Contains 6-digit verification code',
                'reset-email': 'Contains password reset link',
                'resend-code': 'Rate limited to 5 attempts with 60s cooldown',
                'arrow-keys': 'Use ‚Üê ‚Üí arrows to navigate slides',
                'swipe-mobile': 'Swipe gestures on touch devices',
                'back-restrictions': 'Cannot go back from unverified email',
                'skip-conditions': 'Cannot skip mandatory steps',
                'auth-required': 'Must select auth method to proceed',
                'email-verify': 'Must verify email to continue',
                'plan-selection': 'Must select pricing tier',
                'profile-complete': 'Must enter name to finish',
                'session-persist': 'Progress saved across refreshes',
                'refresh-state': 'Maintains step on page reload',
                'rate-limiting': 'Prevents OTP spam with cooldown',
                'error-recovery': 'Handles network failures gracefully',
                'auth-signup': 'Supabase user registration',
                'auth-signin': 'Supabase authentication',
                'auth-reset': 'Supabase password reset',
                'auth-resend': 'Supabase OTP resend'
            };

            const description = testDescriptions[testType] || 'Test description not available';

            // Update status
            const statusEl = event.target.querySelector('.status');
            statusEl.textContent = 'Testing';
            statusEl.className = 'status testing';

            // Show test info
            alert(`Testing: ${testType}\n\n${description}\n\nThe test will run in the live site preview below.`);

            // Reset status after delay
            setTimeout(() => {
                statusEl.textContent = 'Ready';
                statusEl.className = 'status ready';
            }, 3000);
        }

        // Initialize
        updateFlowDiagram(1);

        // Simulate navigation updates
        let currentStep = 1;
        let emailVerified = false;

        // Listen for keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' && currentStep < 9) {
                currentStep++;
                updateFlowDiagram(currentStep);
                document.getElementById('navMode').textContent = 'Keyboard';
            } else if (e.key === 'ArrowLeft' && currentStep > 1) {
                currentStep--;
                updateFlowDiagram(currentStep);
                document.getElementById('navMode').textContent = 'Keyboard';
            }
        });
    </script>
</body>
</html>